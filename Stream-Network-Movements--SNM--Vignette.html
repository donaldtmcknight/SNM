<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Donald T. McKnight" />

<meta name="date" content="2025-01-17" />

<title>Stream Network Movements (SNM) Vignette</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Stream Network Movements (SNM)
Vignette</h1>
<h4 class="author">Donald T. McKnight</h4>
<h4 class="date">2025-01-17</h4>


<div id="TOC">
<ul>
<li><a href="#introduction-and-overview" id="toc-introduction-and-overview">Introduction and overview</a></li>
<li><a href="#input-data" id="toc-input-data">Input data</a>
<ul>
<li><a href="#overview" id="toc-overview">Overview</a></li>
<li><a href="#shapefile" id="toc-shapefile">Shapefile</a></li>
<li><a href="#nodes" id="toc-nodes">Nodes</a></li>
<li><a href="#animal-positions" id="toc-animal-positions">Animal
positions</a></li>
</ul></li>
<li><a href="#using-the-package-example" id="toc-using-the-package-example">Using the package (example)</a>
<ul>
<li><a href="#prep.data" id="toc-prep.data">prep.data()</a></li>
<li><a href="#calc.stream.dist" id="toc-calc.stream.dist">calc.stream.dist()</a></li>
<li><a href="#movements" id="toc-movements">Movements()</a></li>
<li><a href="#dist.over.time" id="toc-dist.over.time">dist.over.time()</a>
<ul>
<li><a href="#plotting-and-summarizing-dist.over.time-results" id="toc-plotting-and-summarizing-dist.over.time-results">Plotting and
summarizing dist.over.time() results</a></li>
</ul></li>
</ul></li>
<li><a href="#troubleshooting-and-suggestions" id="toc-troubleshooting-and-suggestions">Troubleshooting and
suggestions</a>
<ul>
<li><a href="#long-run-times" id="toc-long-run-times">Long run
times</a></li>
<li><a href="#errors-warnings-and-other-issues" id="toc-errors-warnings-and-other-issues">Errors, warnings, and other
issues</a></li>
<li><a href="#pseudoreplication-multiple-points-per-period" id="toc-pseudoreplication-multiple-points-per-period">Pseudoreplication
(multiple points per period)</a></li>
</ul></li>
</ul>
</div>

<div id="introduction-and-overview" class="section level1">
<h1>Introduction and overview</h1>
<p>This package is designed to analyze movement patterns of animals
within stream networks. It includes four main functions:</p>
<ul>
<li><em>prep.data()</em> = takes the raw input data and formats it for
analysis, including creating lookup tables to increase speed.</li>
<li><em>calc.stream.dist()</em> = calculates the minimum distance along
a stream network between two points.</li>
<li><em>movements()</em> = calculates the total space use (stream
length), distance between consecutive points, cumulative movement over
time, and the direction of movement</li>
<li><em>dist.over.time()</em> = calculates distances moved over given
time intervals (e.g., distances moved over 24 hours, over 48 hours,
etc.)</li>
</ul>
<p>All results are reported in meters and represent minimum distances
moved travelling down the center line of a stream (i.e., they are stream
length distances). While stream networks can include any number of
branches, they cannot include any braids (i.e., streams cannot split and
rejoin, forming islands). See the input section for additional
details.</p>
<p>This vignette includes examples of input data and how to run the
functions, as well as additional details about how the functions work
(with relevant considerations for the accuracy of the data).</p>
</div>
<div id="input-data" class="section level1">
<h1>Input data</h1>
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Three input objects are required:</p>
<ul>
<li>Shapefile (polyline) of the stream network, describing the center
line of the stream</li>
<li>Data frame with the coordinates and IDs of each node</li>
<li>Data frame with the coordinates, IDs, and (optionally) dates and
times each time an animal was tracked (dates and times are required for
the <em>dist.over.time()</em> function and highly recommended for
<em>movements()</em>)</li>
</ul>
<p>All three objects must be in the same projected format and coordinate
system (this package was written and tested using decimal degrees).</p>
<p>A fourth object (a shapefile showing the boundaries of the stream)
has been included for illustrative purposes, but you do not need a
boundary shapefile to use the package.</p>
</div>
<div id="shapefile" class="section level2">
<h2>Shapefile</h2>
<p>To use this package, you need a shapefile of the stream network you
want to analyze. This should be a polyline that runs down the center of
the stream, where each segment of the network has a different ID
(label). “Segments” refer to “edges” of a network, with the section of
stream between any two nodes counting as a unique segment. Nodes must be
included anywhere that two segments meet as well as at the ends of any
terminal segments.</p>
<p>Let’s look at the <em>stream.line</em> and <em>nodes</em> objects
that come with the <strong>SNM</strong> package. We’ll also include a
polygon shapefile showing the boundaries of the stream. This shapefile
is not actually needed for any functions; it is just included here
illustrate the point that the polyline you need should run down the
center of the stream.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggnewscale)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(SNM)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.boundaries,<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>,<span class="at">color=</span><span class="st">&quot;lightblue&quot;</span>)<span class="sc">+</span> <span class="co">#include the shapefile of the stream area as an illustration</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.line,<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(id)),<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span> <span class="co">#include the required shapefile of the center of the stream network including each segment</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>,<span class="at">fill=</span><span class="st">&quot;Points&quot;</span>)<span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  <span class="fu">new_scale_color</span>() <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nodes,<span class="fu">aes</span>(<span class="at">y=</span>lat,<span class="at">x=</span>lon),<span class="at">size=</span><span class="dv">2</span>) <span class="co">#include the nodes</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Here we can see a branching stream network with 7 segments (colored
lines) and 8 nodes (black points). Each segment follows the center of a
stream channel, and each node occurs at the junction of two or more
segments or the start or end of a terminal segment.</p>
<p>Note that larger stream networks will take longer to run, and you
should trim your network to only include the areas used by your animals.
Remove any side branches that animals never visited (to your knowledge)
and trim terminal segments to only include the areas you know animals
visited.</p>
<p>Stream networks cannot include braids (i.e., sections where the
streams fork and reconnect later, forming islands). If your system is
braided, you can still analyze it if your tracking efforts were focused
on main channels such that you can strategically remove braids from the
network and leave a minimum path behind that contains no braids.
Alternatively, you may be able to assess movements in small chunks,
using subsets of the data that do not include braids.</p>
<p>I recommend creating shapefiles in a program like ArcGIS or QGIS. You
can either trace a stream specifying segments as you go, or download an
existing shapefile and split it into appropriate segments. Load it into
R using the <em>st_read()</em> function in the <strong>sf</strong>
package.</p>
<p>Note that you must have an ID for each segment, even if your
“network” is a single linear stream channel (one segment). Segment IDs
should be integers.</p>
</div>
<div id="nodes" class="section level2">
<h2>Nodes</h2>
<p>Nodes occur at the intersection of segments or the start and end of
terminal segments (see the Shapefile section). The node object needs to
be a data frame with 3 columns containing the latitude, longitude, and
ID of each node. You can specify the names of the columns in the
<em>prep.data()</em> function, but the defaults are “lat”, “lon” and
“id”, respectively. The ID column must be integers. Node IDs do not need
to correspond in any meaningful way with segment IDs.</p>
<p>An example node object (<em>nodes</em>) is provided</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>nodes</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt;         lon      lat id</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt; 1 -88.99856 17.17619  1</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; 2 -88.99856 17.17692  2</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; 3 -88.99873 17.17859  3</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; 4 -88.99811 17.17722  4</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; 5 -88.99764 17.17754  5</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; 6 -88.99801 17.17837  6</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; 7 -88.99715 17.17834  7</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; 8 -88.99900 17.17756  8</span></span></code></pre></div>
<p>Note that you must have a node object, even if your “network” is a
single linear stream channel (i.e., one segment with a node on each
end).</p>
<p>Note that for internal calculations, the node object is paired with
the segments in the shapefile object by identifying the closest matches
between points in both objects. Thus, it automatically detects which
nodes go with which segments. Additionally, the ending points for each
segment in the shapefile do not need to perfectly match the coordinates
of the nodes, but they should be as close as reasonably possible,
because large differences will result in inaccurate calculations.</p>
</div>
<div id="animal-positions" class="section level2">
<h2>Animal positions</h2>
<p>Finally, you need a data frame containing the locations each time an
animal was tracked. At a minimum, this data frame should include columns
for latitude, longitude, and the ID of each animal. You can specify the
names of the columns in the functions, but the defaults are “lat”, “lon”
and “id”, respectively.</p>
<p>The ID column does not require a specific format and can include
characters.</p>
<p>Optionally, you can include a column of date and time information (in
the POSIX format). This column is called “date.time” by default, but you
can specify an alternate name in the functions. This column is required
for the <em>dist.over.time()</em> function and highly recommended for
the <em>movements()</em> function.</p>
<p>Additional columns of metadata can optionally be included and will be
returned alongside the outputs of the <em>movements()</em> function.</p>
<p>The <em>dist.over.time()</em> and <em>movements()</em> functions loop
over each individual, providing outputs per individual.</p>
<p>An example object (<em>animal.points</em>) is included. Note that
this object contains 2 sets of latitude and longitude. This is strictly
for illustrative purposes and your object should only include one
set.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>animal.points</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">#&gt;      lon.raw  lat.raw lon.shifted lat.shifted      id           date.time point</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; 1  -88.99845 17.17668   -88.99855    17.17668 turtle1 2023-01-01 12:00:00     1</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 2  -88.99848 17.17698   -88.99848    17.17698 turtle1 2023-01-02 12:00:00     2</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 3  -88.99838 17.17710   -88.99834    17.17707 turtle1 2023-01-03 12:00:00     3</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 4  -88.99874 17.17835   -88.99869    17.17835 turtle2 2023-01-01 12:30:00     1</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 5  -88.99849 17.17765   -88.99851    17.17765 turtle2 2023-01-01 13:00:00     2</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 6  -88.99792 17.17732   -88.99794    17.17734 turtle2 2023-01-02 12:00:00     3</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 7  -88.99783 17.17794   -88.99781    17.17794 turtle2 2023-01-03 12:00:00     4</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 8  -88.99747 17.17784   -88.99747    17.17784 turtle2 2023-01-06 12:00:00     5</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 9  -88.99776 17.17746   -88.99776    17.17746 turtle2 2023-01-07 18:00:00     6</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 10 -88.99875 17.17700   -88.99871    17.17703 turtle2 2023-01-08 12:00:00     7</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; 11 -88.99889 17.17730   -88.99895    17.17730 turtle2 2023-01-09 12:00:00     8</span></span></code></pre></div>
<p>This package can be used with automated stations, where the
coordinates describe each station with a row of data each time an animal
was detected at a given station.</p>
<p>To calculate distances, for each animal coordinate, it identifies the
corresponding point along the network shapefile that is closest to that
point. Thus, for the distance between a pair of points, it actually
calculates the distance down the center of the stream (following the
shapefile) between those two points. As a result, all distances are
calculated as stream length distances, and movements across stream
channels may not be accurately included. For example, if an animal swims
straight across a stream between two points without moving up or down
the channel, that will be returned as a movement of 0 meters. This is
only problematic when looking at movements over a very small spatial
scale or in very wide river systems.</p>
<p>Because each animal point is matched to the closest point in the
shapefile object, the frequency of points in the shapefile affects the
accuracy of the calculations (see the <em>prep.data()</em> section for
details on how to easily increase the point frequency).</p>
<p>Note that there may be issues in the rare case where one very wide
channel runs parallel to a narrow channel, with only a small strip of
land between them. In that situation, an animal on the edge of the wide
channel could mistakenly get assigned to the smaller channel. If this is
a concern in your system, simply manually adjust relevant points to be
closer to the center line of the channel they actually occurred in.
Doing so will not affect the accuracy of results. This should not be
necessary in the vast majority of data sets.</p>
<p>It is highly recommended that you plot your data in R or elsewhere to
check for aberrant or inaccurate points before running this package.</p>
</div>
</div>
<div id="using-the-package-example" class="section level1">
<h1>Using the package (example)</h1>
<div id="prep.data" class="section level2">
<h2>prep.data()</h2>
<p>Before running any calculations, you need to use the
<em>prep.data()</em> function to format the stream network for the
functions and calculate lookup tables to increase the speed of
subsequent functions. This function takes the stream network object
(shapefile) and the node object (data frame).</p>
<p>Pay attention to the <em>freq</em> argument. This will add additional
points between each pair of points in the stream network shapefile, thus
greatly improving the accuracy of subsequent calculations. If, for
example, your stream included a straight segment that was 1 km long, the
shapefile might only have a coordinate included at each end of that
segment. As a result, when matching the animal coordinates with the
shapefile coordinates, any animals in between those two coordinates
would get paired with one of those end coordinates, thus moving them
very far from their actual locations. In contrast, setting <em>freq</em>
= 1 would add an additional coordinate each meter between those two end
coordinates, thus providing a close match for each animal point.</p>
<p>The <em>freq</em> argument is specified in meters, so the lower the
number, the tighter the resolution and the higher the accuracy in the
data. However, lower numbers also increase the run time. Thus, you
should carefully select a number that balances the two based on your
study system and computer resources. If your animals regularly move
dozens of kilometers, a higher number like 10 will likely be sufficient.
In contrast, if your animals only move very small distances, smaller
numbers like 1 or 0.5 may be needed. The total size of the system also
greatly affects run time. So a system that includes many kilometers may
need a larger value. If you have a large system when looking at all
animals, but each individual only uses a small portion of the system, it
may be more efficient to run the functions separately on each
individual, with a low <em>freq</em> per individual and the shapefile
trimmed to only the area used by that individual.</p>
<p>To illustrate, let’s run the example data through
<em>prep.data()</em> at several values of <em>freq</em> then plot the
results.</p>
<p>First, let’s use a high value (<em>freq</em>=20). We’ll provide the
function with the shapefile (l = stream.line) and nodes data frame
(nodes = nodes). The lat, lon, and id columns are already named
following the defaults, so we do not actually have to specify them, but
for illustrative purposes, we’ll go ahead and do so.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>network<span class="fl">.20</span> <span class="ot">&lt;-</span> <span class="fu">prep.data</span>(<span class="at">l=</span>stream.line,<span class="at">freq=</span><span class="dv">20</span>,<span class="at">nodes=</span>nodes,<span class="at">lon.name=</span><span class="st">&quot;lon&quot;</span>,<span class="at">lat.name=</span><span class="st">&quot;lat&quot;</span>,<span class="at">node.name=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#the increased.line object contains the new coordinates that were added</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">ggplot</span>(network<span class="fl">.20</span><span class="sc">$</span>increased.line,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat,<span class="at">color=</span><span class="fu">as.character</span>(id)))<span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>As you can see, now instead of a line for each segment, we have a
series of points separated by no more than 20 m (sometimes less at the
ends if a segment was not evenly dividable by 20). This will give us a
better resolution than the initial shapefile, but is still pretty crude.
Let’s do it again at 10 m</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>network<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">prep.data</span>(<span class="at">l=</span>stream.line,<span class="at">freq=</span><span class="dv">10</span>,<span class="at">nodes=</span>nodes,<span class="at">lon.name=</span><span class="st">&quot;lon&quot;</span>,<span class="at">lat.name=</span><span class="st">&quot;lat&quot;</span>,<span class="at">node.name=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">ggplot</span>(network<span class="fl">.10</span><span class="sc">$</span>increased.line,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat,<span class="at">color=</span><span class="fu">as.character</span>(id)))<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This is an obvious improvement with closer points, but for such a
small area and small data set, we can go narrower, so let’s use 1 m</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>network<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">prep.data</span>(<span class="at">l=</span>stream.line,<span class="at">freq=</span><span class="dv">1</span>,<span class="at">nodes=</span>nodes,<span class="at">lon.name=</span><span class="st">&quot;lon&quot;</span>,<span class="at">lat.name=</span><span class="st">&quot;lat&quot;</span>,<span class="at">node.name=</span><span class="st">&quot;id&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">ggplot</span>(network<span class="fl">.1</span><span class="sc">$</span>increased.line,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat,<span class="at">color=</span><span class="fu">as.character</span>(id)))<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now the points are so close together that they almost look like a
solid line. We’ll use this resolution moving forward. The
<em>network.1</em> object is a list containing all the information on
the stream network necessary for all subsequent calculations.</p>
</div>
<div id="calc.stream.dist" class="section level2">
<h2>calc.stream.dist()</h2>
<p>This is a core function used internally by the other functions and
simply calculates the shortest distance between two points within the
stream network by following the center line of the stream (i.e., this is
a stream length distance). To use it separately from the other
functions, we simply supply it with two coordinates (in the same
projected system as the stream network) and the stream network object
made previously using <em>prep.data()</em>. Coordinates need to be
entered as vectors with longitude followed by latitude.</p>
<p>For example, let’s look at two hypothetical positions. Note that the
points do not perfectly align with the network object because, in a real
system, the network object represents only the center line down a stream
channel, and animals may be anywhere within the channel. We’ll include
the <em>stream.boundaries</em> object to illustrate this.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.boundaries,<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>,<span class="at">color=</span><span class="st">&quot;lightblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>network<span class="fl">.1</span><span class="sc">$</span>increased.line,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat,<span class="at">color=</span><span class="fu">as.character</span>(id)),<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>  <span class="fu">new_scale_color</span>()<span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">88.99900</span>,<span class="at">y=</span><span class="fl">17.1774</span>),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span><span class="fl">88.99865</span>,<span class="at">y=</span><span class="fl">17.17837</span>),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">size=</span><span class="dv">6</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>To calculate the distance between these points following the stream
network, we simply run the following (note that we must supply the
network object):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">calc.stream.dist</span>(<span class="at">p1=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">88.99900</span>,<span class="fl">17.1774</span>),<span class="at">p2=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">88.99865</span>,<span class="fl">17.17837</span>),<span class="at">data=</span>network<span class="fl">.1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [1] 280.0319</span></span></code></pre></div>
<p>This shows that the points are 280.03 m apart following the center
lines of the stream network.The calculation was performed by using the
lookup tables to determine the distance from the point on the left to
the lower node on segment 3, the entire length of segment 2, and the
distance from the lower node on segment 4 to the second point. Those
distances were then summed.</p>
</div>
<div id="movements" class="section level2">
<h2>Movements()</h2>
<p>In most cases, we want to look at large chunks of data, not two
individual points. The <em>movements()</em> function lets us do
this.</p>
<p>To illustrate, let’s use the <em>animal.points</em> data frame that
comes with <strong>SNM</strong>. It contains two sets of coordinates.
The “raw” set contains the actual data and is the only set needed for
analyses. The “shifted” points are simply to illustrate how the
functions work. Let’s start by plotting the raw data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>nodes<span class="sc">$</span>nodes <span class="ot">&lt;-</span> <span class="st">&quot;nodes&quot;</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>   <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.boundaries,<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>,<span class="at">color=</span><span class="st">&quot;lightblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.line,<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(id)),<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>,<span class="at">fill=</span><span class="st">&quot;Points&quot;</span>,<span class="at">x=</span><span class="st">&quot;lon&quot;</span>,<span class="at">y=</span><span class="st">&quot;lat&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  <span class="fu">new_scale_color</span>() <span class="sc">+</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>animal.points,<span class="fu">aes</span>(<span class="at">x=</span>lon.raw,<span class="at">y=</span>lat.raw,<span class="at">fill=</span>id))<span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>animal.points,<span class="at">label=</span>animal.points<span class="sc">$</span>point,<span class="fu">aes</span>(<span class="at">x=</span>lon.raw,<span class="at">y=</span>lat.raw,<span class="at">color=</span>id),<span class="at">nudge_y=</span><span class="fl">0.00015</span>,<span class="at">nudge_x=</span><span class="fl">0.00008</span>)<span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nodes,<span class="fu">aes</span>(<span class="at">y=</span>lat,<span class="at">x=</span>lon,<span class="at">fill=</span>nodes),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>nodes,<span class="at">label=</span>nodes<span class="sc">$</span>id,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat),<span class="at">nudge_y=</span><span class="fl">0.00015</span>,<span class="at">nudge_x=</span><span class="fl">0.00008</span>)<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>animal.points,<span class="fu">aes</span>(<span class="at">x=</span>lon.raw,<span class="at">y=</span>lat.raw,<span class="at">fill=</span>id),<span class="at">shape=</span><span class="dv">22</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Here we have coordinates for two turtles. As you can see, they are
within the stream boundaries, but aren’t lined up with the center line
object. The functions in <strong>SNM</strong> will take care of that by
matching each point with the closest point on the stream network using
the object generated in <em>prep.data()</em>, but for illustrative
purposes, let’s plot roughly what that looks like using the “shifted”
columns (these were generated manually and are not overly accurate;
again, just for illustration).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>   <span class="co">#geom_sf(data=stream.boundaries,fill=&quot;lightblue&quot;,color=&quot;lightblue&quot;)+</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>stream.line,<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">as.factor</span>(id)),<span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_blank</span>(),<span class="at">panel.background=</span><span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">&quot;Stream</span><span class="sc">\n</span><span class="st">segments&quot;</span>,<span class="at">fill=</span><span class="st">&quot;Points&quot;</span>,<span class="at">x=</span><span class="st">&quot;lon&quot;</span>,<span class="at">y=</span><span class="st">&quot;lat&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="fu">new_scale_color</span>() <span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>animal.points,<span class="fu">aes</span>(<span class="at">x=</span>lon.shifted,<span class="at">y=</span>lat.shifted,<span class="at">fill=</span>id))<span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>animal.points,<span class="at">label=</span>animal.points<span class="sc">$</span>point,<span class="fu">aes</span>(<span class="at">x=</span>lon.shifted,<span class="at">y=</span>lat.shifted,<span class="at">color=</span>id),<span class="at">nudge_y=</span><span class="fl">0.00015</span>,<span class="at">nudge_x=</span><span class="fl">0.00008</span>)<span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))<span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>nodes,<span class="fu">aes</span>(<span class="at">y=</span>lat,<span class="at">x=</span>lon,<span class="at">fill=</span>nodes),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data=</span>nodes,<span class="at">label=</span>nodes<span class="sc">$</span>id,<span class="fu">aes</span>(<span class="at">x=</span>lon,<span class="at">y=</span>lat),<span class="at">nudge_y=</span><span class="fl">0.00015</span>,<span class="at">nudge_x=</span><span class="fl">0.00008</span>)<span class="sc">+</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>animal.points,<span class="fu">aes</span>(<span class="at">x=</span>lon.shifted,<span class="at">y=</span>lat.shifted,<span class="at">fill=</span>id),<span class="at">shape=</span><span class="dv">22</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Now you can see that the points are perfectly aligned with the center
of lines of the stream network and the boundary shapefile is irrelevant.
Again, you do not need to do this alignment manually. This is simply an
illustration to show what the functions are doing internally (you also
do not need the boundary shapefile object).</p>
<p>Now that we have plotted the data, let’s do the actual analysis.
There are several options for what calculations to run. We will run them
all by setting <em>space.use</em>, <em>from.previous</em>, and
<em>cumulative</em> to TRUE. We also need to include the name of the
node that is furthest downstream (in this case 1). The date.time column
is not strictly necessary, but without it, it is important that the data
are sorted from oldest to newest (the <em>dist.from.prev()</em> and
<em>cumulative.dist()</em> functions will not give correct results
otherwise). If the date.time column is included, the data will be sorted
internally (including it is highly recommended).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>move.results <span class="ot">&lt;-</span> <span class="fu">movements</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>          <span class="at">space.use=</span>T,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>          <span class="at">from.previous=</span>T,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>          <span class="at">cumulative=</span>T,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>          <span class="at">downstream.node=</span><span class="dv">1</span>,</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>          <span class="at">coords=</span>animal.points,</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>          <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>          <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>          <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>          <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individal turtle1&quot;</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individal turtle2&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>move.results</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;    lon.shifted lat.shifted           date.time point space.use dist.from.prev</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; 1    -88.99855    17.17668 2023-01-01 12:00:00     1        NA             NA</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 2    -88.99848    17.17698 2023-01-02 12:00:00     2  37.16384       37.00000</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; 3    -88.99834    17.17707 2023-01-03 12:00:00     3  53.16384       16.00000</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; 4    -88.99869    17.17835 2023-01-01 12:30:00     1        NA             NA</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 5    -88.99851    17.17765 2023-01-01 13:00:00     2  81.84138       81.84138</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 6    -88.99794    17.17734 2023-01-02 12:00:00     3 169.12858       87.28720</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; 7    -88.99781    17.17794 2023-01-03 12:00:00     4 256.56658       87.43800</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 8    -88.99747    17.17784 2023-01-06 12:00:00     5 293.56658       86.00000</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 9    -88.99776    17.17746 2023-01-07 18:00:00     6 293.56658       52.43800</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; 10   -88.99871    17.17703 2023-01-08 12:00:00     7 373.41909      125.85252</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; 11   -88.99895    17.17730 2023-01-09 12:00:00     8 414.46992       41.05082</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt;    cumulative.dist dist.from.downstream  direction time.diff       lon      lat</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; 1               NA              55.0000       &lt;NA&gt;        NA -88.99845 17.17668</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; 2         37.00000              92.0000   upstream      24.0 -88.99848 17.17698</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; 3         53.00000             108.0000   upstream      24.0 -88.99838 17.17710</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; 4               NA             285.9811       &lt;NA&gt;        NA -88.99874 17.17835</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt; 5         81.84138             204.1397 downstream       0.5 -88.99849 17.17765</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; 6        169.12858             162.8525 downstream      23.0 -88.99792 17.17732</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; 7        256.56658             250.2905   upstream      24.0 -88.99783 17.17794</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; 8        342.56658             238.2905 downstream      72.0 -88.99747 17.17784</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; 9        395.00457             185.8525 downstream      30.0 -88.99776 17.17746</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; 10       520.85709             104.0000 downstream      18.0 -88.99875 17.17700</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; 11       561.90791             145.0508   upstream      24.0 -88.99889 17.17730</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt;         id</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; 1  turtle1</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt; 2  turtle1</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; 3  turtle1</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; 4  turtle2</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; 5  turtle2</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; 6  turtle2</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; 7  turtle2</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a><span class="co">#&gt; 8  turtle2</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a><span class="co">#&gt; 9  turtle2</span></span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a><span class="co">#&gt; 10 turtle2</span></span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a><span class="co">#&gt; 11 turtle2</span></span></code></pre></div>
<p>This outputs a data frame with all of the input data, plus multiple
additional columns:</p>
<ul>
<li>“space.use” was returned by setting <em>space.use</em> = T and is
the entire length of stream used by an animal up to and including a
given point. No portion of stream is counted more than once, so on a
straight system with no branches, it would simply be the distance
between the furthest two points. Notice that the “space.use” does not
increase from points 5 to 6 for turtle2, because the movement from 5 to
6 was entirely within an area the turtle had already used. The final
value per individual indicates the total length of stream used and can
be viewed as a measure of home range (depending on the system and study
organism).
<ul>
<li>In this example, for turtle2, the final space use was the sum of:
most of segments 3 and 4, all of segments 2 and 5, and the lower portion
of segments 6 and 7 (i.e., it is the shortest path connecting all the
points without duplicating any paths). Nothing from segment 1 was
included, because there was no evidence of the turtle visiting it. Keep
in mind, however, that these are minimum estimates. In many cases, it
may have been possible that the turtle did go down segment 1, but was
simply not tracked while it was in that segment.</li>
<li>Note also that the “space.use” for turtle2 did not increase from
points 5 to 6, because that movement was entirely within an area where
the turtle had already been documented (see contrast with
“cumulative.dist”)</li>
</ul></li>
<li>“dist.from.prev” was returned by setting <em>from.prev</em> = T and
simply shows the distance between each point and the previous point for
an individual.</li>
<li>“cumulative.dist” was returned by setting <em>cumulative</em> = T
and is the cumulative area used by an individual up to and including the
given point. This differs from “space.use” in that areas are counted
every time an animal uses them. Thus, this is a measure of the total
distance traveled from the start and is the same as the sum of all
“dist.from.prev” measurements up to and including the given
measurement.</li>
<li>“dist.from.downstream” was returned by including the
<em>downstream.node</em> and shows the distance from each point to the
furthest node downstream.</li>
<li>“direction” was returned by including the <em>downstream.node</em>
and shows whether the animal moved further (upstream) or closer
(downstream) to the furthest downstream node</li>
<li>“time.diff” was returned by including a date.time column and shows
the amount of time (in hours) that passed between two points.</li>
</ul>
<p>Note that for each individual, the first row is mostly NA because the
animal has, by definition, not moved yet.</p>
<p>Plotting some of these outputs can give useful insights into animal
movement patterns. For example, if we plot the space use of turtle 2, we
can see that at first, its space use increased rapidly, before
stagnating while it moved around in an area where it had already been
documented, followed by another large movement. If you have tracked an
animal long enough to establish its home range, you should see this line
asymptote. That clearly is not the case here.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">ggplot</span>(move.results[move.results<span class="sc">$</span>id<span class="sc">==</span><span class="st">&quot;turtle2&quot;</span>,],<span class="fu">aes</span>(<span class="at">x=</span>date.time,<span class="at">y=</span>space.use))<span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_blank</span>())</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; (`geom_point()`).</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 1 row containing missing values or values outside the scale range</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="dist.over.time" class="section level2">
<h2>dist.over.time()</h2>
<p>The final function is designed to look at movement patterns over
specified amounts of time. There are a lot of options for this function,
so we’ll go through a few examples.</p>
<p>First, imagine that you want to look at movement patterns as the
number of days increased between points. So, you want to know how far
animals moved over 24 hours, over 48 hours, over 72 hours, etc. This
function lets you do that by taking each point and looking for a
previous point that matches the specified time interval, then getting
the distance between those two points. We can set this up by telling the
function to use days as the units and increase the days by 1 for each
time interval (set this with the <em>time.diff</em> argument; note that
we could also have set <em>units</em> to “hours” and <em>time.diff</em>
to 24 to get the same result). We’d like to look at the maximum possible
spread of days, so for now we’ll leave <em>diff.max</em> on it’s default
NULL setting. Also, for now, let’s shut off the sensitivity arguments by
setting them to 0.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">1</span>,</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>               <span class="at">diff.max=</span><span class="cn">NULL</span>,</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="dv">0</span>,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="dv">0</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="dv">0</span>)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 1 days from 1 days to 8 days&quot;</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0 days and increases by 0 days every 1 days&quot;</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="co">#&gt;           lon      lat      id           date.time      dist actual.diff</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; 2   -88.99848 17.17698 turtle1 2023-01-02 12:00:00  37.00000           1</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co">#&gt; 3   -88.99838 17.17710 turtle1 2023-01-03 12:00:00  16.00000           1</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="co">#&gt; 31  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.00000           2</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="co">#&gt; 7   -88.99783 17.17794 turtle2 2023-01-03 12:00:00  87.43800           1</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="co">#&gt; 8   -88.99747 17.17784 turtle2 2023-01-06 12:00:00  86.00000           3</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; 81  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.43800           4</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="co">#&gt; 10  -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.29051           2</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#&gt; 101 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 190.29051           5</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="co">#&gt; 102 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 102.85252           6</span></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="co">#&gt; 11  -88.99889 17.17730 turtle2 2023-01-09 12:00:00  41.05082           1</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="co">#&gt; 111 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 219.34133           3</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="co">#&gt; 112 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 231.34133           6</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a><span class="co">#&gt; 113 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 143.90334           7</span></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="co">#&gt;     time.diff sensitivity</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="co">#&gt; 2           1           0</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="co">#&gt; 3           1           0</span></span>
<span id="cb13-34"><a href="#cb13-34" tabindex="-1"></a><span class="co">#&gt; 31          2           0</span></span>
<span id="cb13-35"><a href="#cb13-35" tabindex="-1"></a><span class="co">#&gt; 7           1           0</span></span>
<span id="cb13-36"><a href="#cb13-36" tabindex="-1"></a><span class="co">#&gt; 8           3           0</span></span>
<span id="cb13-37"><a href="#cb13-37" tabindex="-1"></a><span class="co">#&gt; 81          4           0</span></span>
<span id="cb13-38"><a href="#cb13-38" tabindex="-1"></a><span class="co">#&gt; 10          2           0</span></span>
<span id="cb13-39"><a href="#cb13-39" tabindex="-1"></a><span class="co">#&gt; 101         5           0</span></span>
<span id="cb13-40"><a href="#cb13-40" tabindex="-1"></a><span class="co">#&gt; 102         6           0</span></span>
<span id="cb13-41"><a href="#cb13-41" tabindex="-1"></a><span class="co">#&gt; 11          1           0</span></span>
<span id="cb13-42"><a href="#cb13-42" tabindex="-1"></a><span class="co">#&gt; 111         3           0</span></span>
<span id="cb13-43"><a href="#cb13-43" tabindex="-1"></a><span class="co">#&gt; 112         6           0</span></span>
<span id="cb13-44"><a href="#cb13-44" tabindex="-1"></a><span class="co">#&gt; 113         7           0</span></span></code></pre></div>
<p>This gives us an output with the distances moved (dist) over a given
number of days. Carefully note that this is simply distance moved
between a pair of points separated by a given number of days, rather
than distance moved from a fixed point over a given number of days.</p>
<p>Also note that because we set sensitivity to 0, only pairs of points
that exactly matched our time interval could be used (this also means
that “actual.diff” and “time.diff” are identical). As a result, for
turtle2, there is no result for the point recorded on 2023-01-02,
because there was no exact match 1 day previously. Unless you are using
GPS data loggers, this may be problematic, because your points are
unlikely to be separated by such precise time intervals. We can modify
this with the sensitivity arguments. These specify a buffer of time
around each time interval in which points can be included. As an
example, let’s use 0.1 days as the buffer (i.e., the time interval is X
days +/- 0.1 days) and lets make that fixed by leaving
<em>sensitivity.change</em> = 0 (note that both <em>sensitivity.min</em>
and <em>sensitivity.max</em> arguments should be 0.1).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">1</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>               <span class="at">diff.max=</span><span class="cn">NULL</span>,</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="fl">0.1</span>,</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="fl">0.1</span>,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="dv">0</span>)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 1 days from 1 days to 8 days&quot;</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0.1 days and increases by 0 days every 1 days&quot;</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;           lon      lat      id           date.time      dist actual.diff</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; 2   -88.99848 17.17698 turtle1 2023-01-02 12:00:00  37.00000   1.0000000</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; 3   -88.99838 17.17710 turtle1 2023-01-03 12:00:00  16.00000   1.0000000</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; 31  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.00000   2.0000000</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; 6   -88.99792 17.17732 turtle2 2023-01-02 12:00:00 169.12858   0.9791667</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; 7   -88.99783 17.17794 turtle2 2023-01-03 12:00:00  87.43800   1.0000000</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; 71  -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.56658   1.9791667</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; 8   -88.99747 17.17784 turtle2 2023-01-06 12:00:00  86.00000   3.0000000</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; 81  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.43800   4.0000000</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; 82  -88.99747 17.17784 turtle2 2023-01-06 12:00:00 244.56658   4.9791667</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; 10  -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.29051   2.0000000</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt; 101 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 190.29051   5.0000000</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt; 102 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 102.85252   6.0000000</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; 103 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 225.98110   6.9791667</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt; 11  -88.99889 17.17730 turtle2 2023-01-09 12:00:00  41.05082   1.0000000</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt; 111 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 219.34133   3.0000000</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt; 112 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 231.34133   6.0000000</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt; 113 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 143.90334   7.0000000</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt; 114 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.03192   7.9791667</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt;     time.diff sensitivity</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt; 2           1         0.1</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt; 3           1         0.1</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt; 31          2         0.1</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt; 6           1         0.1</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt; 7           1         0.1</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt; 71          2         0.1</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt; 8           3         0.1</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt; 81          4         0.1</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt; 82          5         0.1</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt; 10          2         0.1</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt; 101         5         0.1</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt; 102         6         0.1</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt; 103         7         0.1</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt; 11          1         0.1</span></span>
<span id="cb14-51"><a href="#cb14-51" tabindex="-1"></a><span class="co">#&gt; 111         3         0.1</span></span>
<span id="cb14-52"><a href="#cb14-52" tabindex="-1"></a><span class="co">#&gt; 112         6         0.1</span></span>
<span id="cb14-53"><a href="#cb14-53" tabindex="-1"></a><span class="co">#&gt; 113         7         0.1</span></span>
<span id="cb14-54"><a href="#cb14-54" tabindex="-1"></a><span class="co">#&gt; 114         8         0.1</span></span></code></pre></div>
<p>Now you can see that there are more results returned, and the
“actual.diff” column (showing the actual amount of time separating
points) is often different from the “time.diff” column (showing the
interval it was set to). Also note that now there is a result for
turtle2 on 2023-01-02 because there was a point 0.979 days previously,
which is within the time interval of 1 day +/- 0.1 days. Also, note that
there were actually two possible matches, one at 2023-01-01 12:30:00 and
one at 2023-01-01 13:00:00. In cases like this, only one result is
returned, and it is the result for the pair where the “actual.diff” is
closest to the “time.diff” (in this case, 2023-01-01 12:30:00).</p>
<p>You’ll also notice that the buffer (sensitivity) remains fixed as the
number of days increases. This may or may not be desirable. In some
cases, you might expect that as a study continues, the odds of an animal
being tracked at the exact same time of day decrease as the length of
time between points increases. Likewise, if you are looking at movements
over 1 day, having points from the same time of day is likely important,
whereas if you are looking at movements over 100 days, it is much less
important that the points were at the same time of day. You can
incorporate that into this function by using the
<em>sensitivity.change</em> argument to specify an amount of additional
buffer to be added each time interval. You can also cap this increase by
using the <em>sensitivity.max</em> argument. So, as an example, let’s
start with a sensitivity of 0.1, but increase it by 0.02 each day, with
a maximum sensitivity of 0.2.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">1</span>,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>               <span class="at">diff.max=</span><span class="cn">NULL</span>,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="fl">0.1</span>,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="fl">0.2</span>,</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="fl">0.02</span>)</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 1 days from 1 days to 8 days&quot;</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0.1 days and increases by 0.02 days every 1 days&quot;</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;           lon      lat      id           date.time      dist actual.diff</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; 2   -88.99848 17.17698 turtle1 2023-01-02 12:00:00  37.00000   1.0000000</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; 3   -88.99838 17.17710 turtle1 2023-01-03 12:00:00  16.00000   1.0000000</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; 31  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.00000   2.0000000</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; 6   -88.99792 17.17732 turtle2 2023-01-02 12:00:00 169.12858   0.9791667</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; 7   -88.99783 17.17794 turtle2 2023-01-03 12:00:00  87.43800   1.0000000</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; 71  -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.56658   1.9791667</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; 8   -88.99747 17.17784 turtle2 2023-01-06 12:00:00  86.00000   3.0000000</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; 81  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.43800   4.0000000</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; 82  -88.99747 17.17784 turtle2 2023-01-06 12:00:00 244.56658   4.9791667</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a><span class="co">#&gt; 10  -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.29051   2.0000000</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="co">#&gt; 101 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 190.29051   5.0000000</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; 102 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 102.85252   6.0000000</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a><span class="co">#&gt; 103 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 225.98110   6.9791667</span></span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a><span class="co">#&gt; 11  -88.99889 17.17730 turtle2 2023-01-09 12:00:00  41.05082   1.0000000</span></span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a><span class="co">#&gt; 111 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 219.34133   3.0000000</span></span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a><span class="co">#&gt; 112 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 231.34133   6.0000000</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a><span class="co">#&gt; 113 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 143.90334   7.0000000</span></span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a><span class="co">#&gt; 114 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.03192   7.9791667</span></span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a><span class="co">#&gt;     time.diff sensitivity</span></span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a><span class="co">#&gt; 2           1        0.10</span></span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a><span class="co">#&gt; 3           1        0.10</span></span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a><span class="co">#&gt; 31          2        0.12</span></span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a><span class="co">#&gt; 6           1        0.10</span></span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a><span class="co">#&gt; 7           1        0.10</span></span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a><span class="co">#&gt; 71          2        0.12</span></span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a><span class="co">#&gt; 8           3        0.14</span></span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a><span class="co">#&gt; 81          4        0.16</span></span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a><span class="co">#&gt; 82          5        0.18</span></span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a><span class="co">#&gt; 10          2        0.12</span></span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a><span class="co">#&gt; 101         5        0.18</span></span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a><span class="co">#&gt; 102         6        0.20</span></span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a><span class="co">#&gt; 103         7        0.20</span></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a><span class="co">#&gt; 11          1        0.10</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a><span class="co">#&gt; 111         3        0.14</span></span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a><span class="co">#&gt; 112         6        0.20</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a><span class="co">#&gt; 113         7        0.20</span></span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a><span class="co">#&gt; 114         8        0.20</span></span></code></pre></div>
<p>Notice now that the “sensitivity” column increases as the “time.diff”
increases, but it never exceeds 0.2.</p>
<p>So far so good, but for large data sets, getting a result every day
may result in a very long run time. So let’s get every other day
instead. To do this, we’ll simply change time.diff to 2 and, to be
consistent, we’ll double the sensitivity increase.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">2</span>,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>               <span class="at">diff.max=</span><span class="cn">NULL</span>,</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="fl">0.1</span>,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="fl">0.2</span>,</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="fl">0.04</span>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 2 days from 2 days to 8 days&quot;</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0.1 days and increases by 0.04 days every 2 days&quot;</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="co">#&gt;           lon      lat      id           date.time     dist actual.diff</span></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt; 3   -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.0000    2.000000</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; 7   -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.5666    1.979167</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; 8   -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.4380    4.000000</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; 10  -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.2905    2.000000</span></span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="co">#&gt; 101 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 102.8525    6.000000</span></span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a><span class="co">#&gt; 11  -88.99889 17.17730 turtle2 2023-01-09 12:00:00 231.3413    6.000000</span></span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a><span class="co">#&gt; 111 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.0319    7.979167</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="co">#&gt;     time.diff sensitivity</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="co">#&gt; 3           2        0.10</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a><span class="co">#&gt; 7           2        0.10</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a><span class="co">#&gt; 8           4        0.14</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="co">#&gt; 10          2        0.10</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a><span class="co">#&gt; 101         6        0.18</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="co">#&gt; 11          6        0.18</span></span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a><span class="co">#&gt; 111         8        0.20</span></span></code></pre></div>
<p>There are several other ways that you can control the number of
comparisons being made (run time increases dramatically as number of
comparisons increases). One option is to set a cap on the maximum time
interval you want to analyze. To do this, simply set the
<em>diff.max</em> to the largest time interval you want to examine.</p>
<p>Another option is to supply a vector of custom times, rather than
using a fixed interval of increase. For example, let’s just look at the
results for 2, 4, and 8 days.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="fl">0.1</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="fl">0.2</span>,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="fl">0.02</span>,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>               <span class="at">custom.times =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Using custom sequence of times&quot;</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0.1 days and increases by 0.02 days every 1 days&quot;</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt;          lon      lat      id           date.time     dist actual.diff</span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; 3  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.0000    2.000000</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; 7  -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.5666    1.979167</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; 8  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.4380    4.000000</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; 10 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.2905    2.000000</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; 11 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.0319    7.979167</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt;    time.diff sensitivity</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; 3          2        0.12</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; 7          2        0.12</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; 8          4        0.16</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; 10         2        0.12</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a><span class="co">#&gt; 11         8        0.20</span></span></code></pre></div>
<p>Now we have a very reduced output. This is especially useful for
large data sets that span a long time period. If you have a year of
data, for example, running this every day will produce very long run
times and is probably unnecessary, so something like
<em>custom.times</em> =
c(1,2,3,4,5,6,7,30,60,90,120,160,200,240,300,330,360) may be sufficient
while greatly reducing the run time.</p>
<p>Note that when we use 2, 4 and 8 as our time interval, the
“sensitivity” increased linearly with each 1 time unit increase, even
though most time intervals were not returned (i.e., it increased as if
we had all time intervals from 1-8). Also, <em>sensitivity.min</em> is
always applied to 1 of the specified units. So even though
<em>sensitivity.min</em> = 0.1, the lowest sensitivity value returned
was 0.12 because the lowest time interval used was 2 days (i.e., for day
1 [not returned] sensitivity = 0.1, and for day 2 sensitivity = 0.12).
You can, alternatively, specify a vector of custom sensitivity values,
which will override the other sensitivity arguments. For example, let’s
make it day 2 = 0.1, day 4 = 0.15, and day 8 = 2.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>               <span class="at">custom.times =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>),</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>               <span class="at">custom.sensitivity =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.15</span>,.<span class="dv">2</span>))</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Using custom sequence of times&quot;</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Using custom sequence of sensitivities&quot;</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt;          lon      lat      id           date.time     dist actual.diff</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; 3  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.0000    2.000000</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; 7  -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.5666    1.979167</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; 8  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.4380    4.000000</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; 10 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.2905    2.000000</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; 11 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.0319    7.979167</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt;    time.diff sensitivity</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 3          2        0.10</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 7          2        0.10</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; 8          4        0.15</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; 10         2        0.10</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; 11         8        0.20</span></span></code></pre></div>
<p>Now the sensitivity values simply pair with the time values
supplied.</p>
<p>Note that you can use <em>custom.sensitivity</em> without using
<em>custom.times</em> if, for example, you want a non-linear increase in
sensitivity. If doing this, you must ensure that the length of your
sensitivity vector is the same as the total number of time intervals you
are using.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">1</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>               <span class="at">custom.sensitivity =</span> <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">11</span>,.<span class="dv">13</span>,.<span class="dv">16</span>,.<span class="dv">20</span>,.<span class="dv">25</span>,.<span class="dv">31</span>,.<span class="dv">37</span>))</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 1 days from 1 days to 8 days&quot;</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Using custom sequence of sensitivities&quot;</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="co">#&gt;           lon      lat      id           date.time      dist actual.diff</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="co">#&gt; 2   -88.99848 17.17698 turtle1 2023-01-02 12:00:00  37.00000   1.0000000</span></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="co">#&gt; 3   -88.99838 17.17710 turtle1 2023-01-03 12:00:00  16.00000   1.0000000</span></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co">#&gt; 31  -88.99838 17.17710 turtle1 2023-01-03 12:00:00  53.00000   2.0000000</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="co">#&gt; 6   -88.99792 17.17732 turtle2 2023-01-02 12:00:00 169.12858   0.9791667</span></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co">#&gt; 7   -88.99783 17.17794 turtle2 2023-01-03 12:00:00  87.43800   1.0000000</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co">#&gt; 71  -88.99783 17.17794 turtle2 2023-01-03 12:00:00 256.56658   1.9791667</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="co">#&gt; 8   -88.99747 17.17784 turtle2 2023-01-06 12:00:00  86.00000   3.0000000</span></span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a><span class="co">#&gt; 81  -88.99747 17.17784 turtle2 2023-01-06 12:00:00  75.43800   4.0000000</span></span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a><span class="co">#&gt; 82  -88.99747 17.17784 turtle2 2023-01-06 12:00:00 244.56658   4.9791667</span></span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a><span class="co">#&gt; 9   -88.99776 17.17746 turtle2 2023-01-07 18:00:00 110.28720   6.2083333</span></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co">#&gt; 10  -88.99875 17.17700 turtle2 2023-01-08 12:00:00 178.29051   2.0000000</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a><span class="co">#&gt; 101 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 190.29051   5.0000000</span></span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a><span class="co">#&gt; 102 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 102.85252   6.0000000</span></span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a><span class="co">#&gt; 103 -88.99875 17.17700 turtle2 2023-01-08 12:00:00 225.98110   6.9791667</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a><span class="co">#&gt; 11  -88.99889 17.17730 turtle2 2023-01-09 12:00:00  41.05082   1.0000000</span></span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a><span class="co">#&gt; 111 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 219.34133   3.0000000</span></span>
<span id="cb19-31"><a href="#cb19-31" tabindex="-1"></a><span class="co">#&gt; 112 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 231.34133   6.0000000</span></span>
<span id="cb19-32"><a href="#cb19-32" tabindex="-1"></a><span class="co">#&gt; 113 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 143.90334   7.0000000</span></span>
<span id="cb19-33"><a href="#cb19-33" tabindex="-1"></a><span class="co">#&gt; 114 -88.99889 17.17730 turtle2 2023-01-09 12:00:00 267.03192   7.9791667</span></span>
<span id="cb19-34"><a href="#cb19-34" tabindex="-1"></a><span class="co">#&gt;     time.diff sensitivity</span></span>
<span id="cb19-35"><a href="#cb19-35" tabindex="-1"></a><span class="co">#&gt; 2           1        0.10</span></span>
<span id="cb19-36"><a href="#cb19-36" tabindex="-1"></a><span class="co">#&gt; 3           1        0.10</span></span>
<span id="cb19-37"><a href="#cb19-37" tabindex="-1"></a><span class="co">#&gt; 31          2        0.11</span></span>
<span id="cb19-38"><a href="#cb19-38" tabindex="-1"></a><span class="co">#&gt; 6           1        0.10</span></span>
<span id="cb19-39"><a href="#cb19-39" tabindex="-1"></a><span class="co">#&gt; 7           1        0.10</span></span>
<span id="cb19-40"><a href="#cb19-40" tabindex="-1"></a><span class="co">#&gt; 71          2        0.11</span></span>
<span id="cb19-41"><a href="#cb19-41" tabindex="-1"></a><span class="co">#&gt; 8           3        0.13</span></span>
<span id="cb19-42"><a href="#cb19-42" tabindex="-1"></a><span class="co">#&gt; 81          4        0.16</span></span>
<span id="cb19-43"><a href="#cb19-43" tabindex="-1"></a><span class="co">#&gt; 82          5        0.20</span></span>
<span id="cb19-44"><a href="#cb19-44" tabindex="-1"></a><span class="co">#&gt; 9           6        0.25</span></span>
<span id="cb19-45"><a href="#cb19-45" tabindex="-1"></a><span class="co">#&gt; 10          2        0.11</span></span>
<span id="cb19-46"><a href="#cb19-46" tabindex="-1"></a><span class="co">#&gt; 101         5        0.20</span></span>
<span id="cb19-47"><a href="#cb19-47" tabindex="-1"></a><span class="co">#&gt; 102         6        0.25</span></span>
<span id="cb19-48"><a href="#cb19-48" tabindex="-1"></a><span class="co">#&gt; 103         7        0.31</span></span>
<span id="cb19-49"><a href="#cb19-49" tabindex="-1"></a><span class="co">#&gt; 11          1        0.10</span></span>
<span id="cb19-50"><a href="#cb19-50" tabindex="-1"></a><span class="co">#&gt; 111         3        0.13</span></span>
<span id="cb19-51"><a href="#cb19-51" tabindex="-1"></a><span class="co">#&gt; 112         6        0.25</span></span>
<span id="cb19-52"><a href="#cb19-52" tabindex="-1"></a><span class="co">#&gt; 113         7        0.31</span></span>
<span id="cb19-53"><a href="#cb19-53" tabindex="-1"></a><span class="co">#&gt; 114         8        0.37</span></span></code></pre></div>
<div id="plotting-and-summarizing-dist.over.time-results" class="section level3">
<h3>Plotting and summarizing dist.over.time() results</h3>
<p>The results of this function can be highly informative for
understanding animal movement patterns. At the most simple level, you
can use functions like <em>group_by()</em> in the <strong>dplyr</strong>
package or <em>ddply()</em> in the <strong>plyr</strong> package to
calculate the average distance moved over given amounts of time.</p>
<p>You may also be able to use these data to assess things like seasonal
differences in movement patterns. For example, you could get results for
movement over 24 hours during two seasons, then run a mixed effects
model with “dist” as your response, the season as your fixed effect, and
“id” as your random effect. This would tell you whether the average
distance moved over 24 hours differed between the seasons.</p>
<p>If you have data over many time points, you can also make excellent
GAM visualizations using <strong>ggplot2</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>dist.res <span class="ot">&lt;-</span> <span class="fu">dist.over.time</span>(<span class="at">data=</span>network<span class="fl">.1</span>,</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>               <span class="at">coords=</span>animal.points,</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>               <span class="at">lon.name=</span><span class="st">&quot;lon.raw&quot;</span>,</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>               <span class="at">lat.name=</span><span class="st">&quot;lat.raw&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>               <span class="at">id.name=</span><span class="st">&quot;id&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>               <span class="at">date.time.name=</span><span class="st">&quot;date.time&quot;</span>,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>               <span class="at">units=</span><span class="st">&quot;days&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>               <span class="at">time.diff=</span><span class="dv">1</span>,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>               <span class="at">diff.max=</span><span class="cn">NULL</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>               <span class="at">sensitivity.min=</span><span class="fl">0.1</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>               <span class="at">sensitivity.max=</span><span class="fl">0.2</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>               <span class="at">sensitivity.change=</span><span class="fl">0.02</span>)</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Calculating every 1 days from 1 days to 8 days&quot;</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sensitivity starts at +/- 0.1 days and increases by 0.02 days every 1 days&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle1&quot;</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Analyzing individual turtle2&quot;</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a><span class="fu">ggplot</span>(dist.res[dist.res<span class="sc">$</span>id<span class="sc">==</span><span class="st">&quot;turtle2&quot;</span>,],<span class="fu">aes</span>(<span class="at">x=</span>time.diff, <span class="at">y=</span>dist))<span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">color=</span><span class="st">&quot;blue&quot;</span>,<span class="at">fill=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_blank</span>())</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula = &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This particular example is not that interesting, showing little or no
change in distance moved over time (it is hypothetical and only over 8
days); however, with real data over longer time periods, interesting
patterns often emerge. For example, a line that continues trending up
suggests that an individual is not settling into one area and instead is
continuing to move, with distance increasing as time increases.</p>
<p>In other cases, you may get a pattern where distance increases
quickly for a few days, then largely levels off. This would suggest a
daily activity pattern where an animal moves around quickly within a
small area. So over a short time period the distance goes up quickly,
but over longer times, the distance remains stable because it is always
within the same general area. So distance moved over 20 days is no
different from distance moved over 40 days.</p>
<p>You can also get punctuated patterns, where there is little movement
over many days, followed by a sudden increase in distance, suggesting
that an animal was making small daily movements in a given area before
rapidly transitioning to a new area.</p>
<p>Many other movement patterns are possible and should be interpreted
in light of other available data, but these sorts of visualizations can
help to understand animal movements and behaviors. Here again,
comparison in different times of year, between sexes, etc. may be
informative.</p>
</div>
</div>
</div>
<div id="troubleshooting-and-suggestions" class="section level1">
<h1>Troubleshooting and suggestions</h1>
<div id="long-run-times" class="section level2">
<h2>Long run times</h2>
<p>Some of these functions, especially <em>dist.over.time()</em> may
take a long time to run. Here are some suggestions if you are having
issues with run time</p>
<ul>
<li>Ensure that you have removed any tangential stream segments (i.e.,
segments that animals never used).</li>
<li>Increase the <em>freq</em> argument in <em>prep.data()</em>. This
will reduce the accuracy, so you have to weigh that against run time,
but low <em>freq</em> values dramatically increase run time.</li>
<li>Run the data in chunks (e.g., one individual at a time)</li>
<li>Reduce the number of time intervals you are testing (in
<em>dist.over.time()</em>)</li>
<li>Prune your data to minimize repeated points within a time interval.
As an example, if you are using automated receiving stations, and an
animal sits near one of those stations for several days. You may wrack
up thousands of data points, which will greatly reduce run time. Pruning
that to one point per hour, for example, will greatly reduce run time
without impacting your results (depending on your question, of
course)</li>
<li>Borrow a faster computer</li>
</ul>
</div>
<div id="errors-warnings-and-other-issues" class="section level2">
<h2>Errors, warnings, and other issues</h2>
<ul>
<li>Ensure that all your data are in the same projected format</li>
<li>Plot your data to make sure your stream networks are correct and
your points are within the network</li>
<li>Double check that you have a node at each intersection of segments
and each end of a segment.</li>
<li>Double check that all your nodes are named as an integer and there
are no duplicate names</li>
<li>Double check that segments are designated correctly</li>
<li>Double check that segments are named as an integer and there are no
duplicate names</li>
<li>Check for and remove NA entries in lat, lon, id, and date.time
columns</li>
<li>Make sure your date.time column is in the correct POSIX format</li>
</ul>
<p>When running <em>prep.data()</em> you may get the following warning:
“In increase.stream.points(l = l, freq = freq) : LINESTRING EMPTY for
segment removing that segment because there are no coordinates in
it”</p>
<p>This simply means that there is a segment ID with no geometry
attached to it. This can easily happen when creating shapefiles in a
program like QGIS and is usually not an issue. Plot the shapefile and
ensure that all the segments that are supposed to be there are present.
If they are, you can probably ignore this message, but it would be a
good idea to also plot the “increased.line” object created by
<em>prep.data()</em> to double check that things worked correctly.</p>
<p>When running <em>dist.over.time()</em> you may encounter the error:
“Error in seq.default(sensitivity.min, sensitivity.max,
sensitivity.change) : invalid ‘(to - from)/by’”</p>
<p>This means that your <em>sensitivity.max</em> value is smaller than
your <em>sensitivity.min</em> value.</p>
</div>
<div id="pseudoreplication-multiple-points-per-period" class="section level2">
<h2>Pseudoreplication (multiple points per period)</h2>
<p>Especially with the <em>dist.over.time()</em> function, you should be
cautious about potential pseudoreplication. If, for example, you tracked
an animal multiple times a day, then ran an analysis to look at movement
over 24 hours, the function will take each point and try to pair it with
another point 24 hours previously. The result is that you may get
multiple points on one date matched with points on the previous date.
This is arguably pseudoreplicated because the time span covered by each
pair of points overlaps with the other pairs. Thus, those measurements
of movement over 24 hours are not independent and actually repeat some
of the same chunk of movement data.</p>
<p>To avoid this problem, you may need to filter your data before or
after running <em>dist.over.time()</em> to remove multiple values for a
given time interval ending on a given date (or hour or whatever your
units are). Filtering before running the function will reduce run time,
but could limit your matches unless tracking was done at very consistent
times of day. Alternatively, filtering after running the function will
take longer, but will maximize the usable data and will give the closest
matches for the specified time interval (because when a single point
pairs with several others for a given time interval, only the pair
closest to the specified time interval is used).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
